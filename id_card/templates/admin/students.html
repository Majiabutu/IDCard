{% extends "base.html" %}

{% block title %}All Students{% endblock %}

{% block content %}

<div class="container">
    <h3>Students</h3>
    <hr>

    <div class="dropdown">
        <a class="dropbtn info">Filter By Department &downarrow;</a>
        <ul class="dropdown-content">
            <li><a href="{{ url_for('.students') }}">All</a></li>
            {% for dep in deps %}
            <li><a href="{{ url_for('.filtered_students', dep=dep) }}">{{ dep }}</a></li>
            {% endfor %}
        </ul>
    </div>
    
    <!-- FLASH MESSAGES -->
    {% for category, msg in get_flashed_messages(with_categories=True) %}
    <div class="flash">
        <span class="{{ category }}">{{ msg }}</span>
    </div>
    {% endfor %}

    <div class="center-this flex-input">
        <input type="text" onkeyup="search()" placeholder="Search for student by reg number" id="searchBtn" style="min-width: 250px;">
    </div>

    <a class="button info" href="{{ url_for('.refresh') }}">Refresh</a>

    <table class="u-full-width student">
        <caption>All Students</caption>
        <thead>
            <tr>
                <th>Reg Number</th>
                <th>Fullname</th>
                <th>Department</th>
                <th>ID Ready</th>
                <th>Active</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for st in students %}
            <tr class="{{st.user_id}}">
                <td>{{ st.user_id }}</td>
                <td>
                    {{ st.first_name }} 
                    {% if st.middle_name != '' %}
                    {{ st.middle_name }} 
                    {% endif %}
                    {{ st.last_name }}
                </td>
                <td>{{ st.department }}</td>
                {% if st.id_ready %}
                <td>✔</td>
                {% else %}
                <td>❌</td>
                {% endif %}
                {% if st.is_active %}
                <td>✔</td>
                {% else %}
                <td>❌</td>
                {% endif %}
                <td><a href="{{ url_for('.edit_student', id=st.id) }}" class="button button-primary">Edit</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}